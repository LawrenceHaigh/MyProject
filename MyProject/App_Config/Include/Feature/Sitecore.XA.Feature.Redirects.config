<?xml version="1.0" encoding="utf-8" ?>
<!--

Purpose: This include file enables and configures the Redirects feature.

This feature lets administrator set up redirects for legacy URLs to their new locations.

To disable this file, change its extension to ".disabled".

-->
<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
    <sitecore>
        <events>
            <event name="publish:end">
                <handler type="Sitecore.XA.Feature.Redirects.EventHandlers.RedirectMapCacheClearer, Sitecore.XA.Feature.Redirects" method="ClearCache" />
            </event>
            <event name="publish:end:remote">
                <handler type="Sitecore.XA.Feature.Redirects.EventHandlers.RedirectMapCacheClearer, Sitecore.XA.Feature.Redirects" method="ClearCache" />
            </event>
            <event name="item:saved">
                <handler type="Sitecore.XA.Feature.Redirects.EventHandlers.RedirectMapCacheClearer, Sitecore.XA.Feature.Redirects" method="OnItemSaved" />
            </event>
            <event name="item:saved:remote">
                <handler type="Sitecore.XA.Feature.Redirects.EventHandlers.RedirectMapCacheClearer, Sitecore.XA.Feature.Redirects" method="OnItemSavedRemote" />
            </event>
        </events>
        <pipelines>
            <httpRequestBegin>
                <processor patch:after="*[@type='Sitecore.Pipelines.HttpRequest.ItemResolver, Sitecore.Kernel']" type="Sitecore.XA.Feature.Redirects.Pipelines.HttpRequest.RedirectMapResolver, Sitecore.XA.Feature.Redirects" resolve="true">
                    <CacheExpiration>720</CacheExpiration>
                </processor>
                <processor patch:after="*[@type='Sitecore.Pipelines.HttpRequest.ItemResolver, Sitecore.Kernel']" type="Sitecore.XA.Feature.Redirects.Pipelines.HttpRequestBegin.RedirectItem, Sitecore.XA.Feature.Redirects" resolve="true"/>
            </httpRequestBegin>
        </pipelines>
        <services>
            <register serviceType="Sitecore.XA.Feature.Redirects.Repositories.IRedirectsRepository, Sitecore.XA.Feature.Redirects" implementationType="Sitecore.XA.Feature.Redirects.Repositories.RedirectsRepository, Sitecore.XA.Feature.Redirects" lifetime="Singleton"/>
        </services>
    </sitecore>
</configuration>

