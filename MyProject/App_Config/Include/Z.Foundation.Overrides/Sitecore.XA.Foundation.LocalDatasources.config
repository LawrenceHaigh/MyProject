<?xml version="1.0" encoding="utf-8" ?>
<!--

Purpose: This include file enables and configures the Local Datasources foundation module.

This foundation module enables you to define rendering data sources directly under an item instead of having them in the common/shared repository.

To disable this file, change its extension to ".disabled".

-->
<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
    <sitecore>
        <settings>
            <setting name="XA.Foundation.LocalDatasources.ResolveRenderingDatasourceCacheMaxSize" value="50MB" />
            <setting name="XA.Foundation.LocalDatasources.ResolveRenderingDatasourceCache.Enabled" value="true" />
        </settings>
        <pipelines>
            <createPlaceholderSetting>
                <processor patch:after="*[@type='Sitecore.XA.Foundation.PlaceholderSettings.Pipelines.CreatePlaceholderSetting.GetSettingsRootItem, Sitecore.XA.Foundation.PlaceholderSettings']" type="Sitecore.XA.Foundation.LocalDatasources.Pipelines.CreatePlaceholderSetting.CreatePageDataFolder, Sitecore.XA.Foundation.LocalDatasources" resolve="true" />
            </createPlaceholderSetting>
            <resolveRenderingDatasource>
                <processor patch:before="*[1]" type="Sitecore.XA.Foundation.LocalDatasources.Pipelines.ResolveRenderingDatasource.GetFromCache, Sitecore.XA.Foundation.LocalDatasources" resolve="true" />
                <processor patch:after="*[999]" type="Sitecore.XA.Foundation.LocalDatasources.Pipelines.ResolveRenderingDatasource.SetCache, Sitecore.XA.Foundation.LocalDatasources" resolve="true" />
            </resolveRenderingDatasource>
        </pipelines>
        <events>
            <event name="publish:end">
                <handler type="Sitecore.XA.Foundation.LocalDatasources.EventHandlers.ResolveRenderingDatasourceCacheClearer, Sitecore.XA.Foundation.LocalDatasources" method="OnPublishEnd" />
            </event>
            <event name="publish:end:remote">
                <handler type="Sitecore.XA.Foundation.LocalDatasources.EventHandlers.ResolveRenderingDatasourceCacheClearer, Sitecore.XA.Foundation.LocalDatasources" method="OnPublishEnd" />
            </event>
        </events>
    </sitecore>
</configuration>

